# Лабораторные работы - Автосалон

Проект для выполнения лабораторных работ по PHP и Symfony. Тема: **Автосалон** (машины, марки, цены, клиенты).

**Автор**: fakedesyncc

## Структура проекта

```
lstuweb/
├── project/          # Основное приложение (объединяет все лабораторные работы)
│   ├── public/       # Точка входа (index.php)
│   ├── src/          # Исходный код
│   │   ├── Controllers/  # Контроллеры
│   │   ├── Repository/   # Репозитории для работы с БД
│   │   ├── Service/       # Сервисный слой
│   │   ├── Router/        # Роутинг
│   │   └── ...
│   └── views/        # Представления
├── labs1/            # Лабораторная 1: Docker и настройка окружения
├── labs2/            # Лабораторная 2: Основы PHP и работа с формами
├── labs3/            # Лабораторная 3: Работа с базами данных (MySQL, PDO)
├── labs4/            # Лабораторная 4: MVC-архитектура
├── labs5/            # Лабораторная 5: Авторизация и личный кабинет
├── labs6/            # Лабораторная 6: Генерация отчетов (PDF, Excel, CSV)
└── labs7/            # Лабораторная 7: REST API и улучшения (дополнительно)
```

## Быстрый старт

### 1. Запуск проекта

```bash
# Автоматический запуск (рекомендуется)
make start

# Или вручную
cd labs1
docker-compose up -d
./setup-database.sh
cd ../project
composer install
```

### 2. Доступ к приложению

**Основное приложение** (объединяет все лабораторные работы):
- http://localhost:8080/ - Главная страница
- http://localhost:8080/cars - Управление автомобилями
- http://localhost:8080/auth/login - Авторизация
- http://localhost:8080/profile - Личный кабинет
- http://localhost:8080/reports - Генерация отчетов
- http://localhost:8080/api/cars - REST API

**Отдельные лабораторные работы** (для демонстрации):
- http://localhost:8080/labs1/index.php - Лаб 1
- http://localhost:8080/labs2/index.php - Лаб 2
- http://localhost:8080/labs3/index.php - Лаб 3
- http://localhost:8080/labs4/index.php - Лаб 4
- http://localhost:8080/labs5/index.php - Лаб 5
- http://localhost:8080/labs6/index.php - Лаб 6

## Архитектура проекта

### Основное приложение (project/)

Проект построен по принципу модульной архитектуры:

- **Router** - Маршрутизация запросов
- **Controllers** - Обработка HTTP запросов
- **Service Layer** - Бизнес-логика
- **Repository Pattern** - Работа с базой данных
- **Views** - Представления (шаблоны)
- **Middleware** - Промежуточная обработка запросов
- **Validation** - Валидация данных
- **Security** - CSRF защита

### Лабораторные работы (labs1-labs6)

Каждая лабораторная работа демонстрирует конкретную функциональность:
- **labs1** - Docker окружение
- **labs2** - Работа с формами и CSV
- **labs3** - Подключение к MySQL
- **labs4** - MVC архитектура
- **labs5** - Авторизация и сессии
- **labs6** - Генерация отчетов

## Управление проектом

### Запуск и остановка

```bash
make start    # Запустить Docker окружение
make stop     # Остановить контейнеры
make clean    # Полная очистка (контейнеры, vendor, кеши, сгенерированные файлы)
```

### Тестирование

```bash
cd project
make test              # Unit тесты (без БД)
make test-integration  # Integration тесты (требуется MySQL)
make phpstan          # Статический анализ кода
make docs             # Генерация документации
make all              # Все проверки (без integration тестов)
```

**Примечание**: 
- Unit тесты работают без БД
- Integration тесты автоматически пропускаются, если MySQL недоступен
- Docker credentials не критичны - документация генерируется альтернативным методом

## Технологии

- **PHP 8.1+**
- **Symfony Components** (Console, Dotenv, Routing, Validator)
- **MySQL 8.0**
- **Docker & Docker Compose**
- **Apache**
- **PDO** для работы с БД
- **MVC архитектура**
- **Repository Pattern**
- **Service Layer**
- **Dependency Injection**

## Реализованные улучшения

### Архитектура
- [x] Внедрить Dependency Injection контейнер
- [x] Реализовать Repository pattern для работы с БД
- [x] Добавить Service Layer для бизнес-логики
- [x] Внедрить Event System для расширяемости
- [x] Реализовать Middleware для обработки запросов
- [x] Роутинг для единой точки входа

### Производительность
- [x] Реализовать пагинацию для больших списков данных
- [x] Оптимизировать SQL запросы (индексы)
- [x] Добавить поиск и фильтрацию автомобилей

### Безопасность
- [x] Реализовать CSRF защиту для форм
- [x] Внедрить input sanitization на уровне модели
- [x] Добавить валидацию через кастомные валидаторы
- [x] Добавить rate limiting для API endpoints
- [x] Добавить логирование подозрительной активности

### Функциональность
- [x] Реализовать полноценный REST API
- [x] Добавить поиск и фильтрацию автомобилей
- [x] Генерация отчетов (CSV, Excel, PDF)

### Код качество
- [x] Добавить PHPUnit тесты (unit, integration)
- [x] Настроить PHPStan для статического анализа
- [x] Внедрить CI/CD pipeline (GitHub Actions)
- [x] Добавить документацию через PHPDoc
- [x] Настроить автосборку документации
- [x] Реализовать логирование через PSR-3 совместимый Logger

### DevOps
- [x] Добавить health checks для контейнеров

## Подготовка к коммиту в git

```bash
make clean
git add .
git commit -m "Ваше сообщение"
```

**Автор**: fakedesyncc
